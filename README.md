This project is an online marketplace that operates on the blockchain, as outlined in the final project ideas for the 2018 Developer Program.

To set up and run on a local development server, navigate to the project directory. Enter `ganache-cli` in the terminal to start a development blockchain. Then in a separate terminal window enter `truffle compile` and `truffle migrate` to compile your contracts and deploy them to the development blockchain. Finally, enter `npm run dev` to start a development server.

From there, you can navigate to http://localhost:3000/ to interact with the application. Go to Metamask, log out of your existing account, and select the option to import using account seed phrase. Scroll up to find your mnemonic and copy those ten words into Metamask to restore your account. Finally, in the upper right hand corner of Metamask make sure the network is set to `Localhost 8545`. Now you should be able to refresh your browser to begin interacting with the online marketplace.

The first account on the development blockchain is the owner of the market. The application should recognize that you are the owner and show you a page with functions only available to the owner, including adding administrators and closing the market. From there, create another account in Metamask, copy the address into the form, and click add. You should get a confirmation request from Metamask to confirm the transaction. Note that I have observed an issue where Metamask sets the gas limits for some transactions too low, so if you get an error that the gas limit is exceeded try submitting again with a higher gas limit. After the transaction is mined the user interface will update automatically to show the new administrator. You can add and remove administrators like this as many times as you want.

Next change the account in Metamask to the account you just added as an administrator. The application should recognize that you are an administrator and show you administrator only functions. In these cases these are just adding and removing store owners. Add a third account in Metamask, copy the address, and add this address as a store owner. Once again, you will be prompted to confirm the transaction and then the list of store owners will be updated automatically.

Now change the account in Metamask to the third account. The application should recognize that you are an approved store owner and show you functions to manage your stores and see and withdraw the Ether your store has collected from sales. Try creating, updating, and deleting stores and products and see how the user interface is updated accordingly.

Finally, once you have created some stores and products, create a fourth account in Metamask that is not an administrator or store owner. This time, the application should recognize that you are a generic user and let you browse all the stores on the market. Try buying a couple of the items you created and watch how the inventory levels get updated. From there you can switch back to the store owner account, view the funds in your store, and withdraw them.

If you go back to the first account you can click on the button to close the market. This implements an emergency stop and prevents all state modifying functions from being invoked other than withdrawal of ether by store owners. You can go to one of the other accounts to see how the user interface is updated to reflect this. As the owner, open the market again to restore normal functionality.

There are a couple of other things to note about this application.

First, while it appears that all the information is being saved directly to the blockchain, the application is actually using IPFS to store product descriptions and just saving the IPFS hash to the blockchain. In this test environment this serves more as a demonstration but in a real world application with files like images this could be critical to store these files cost effectively in a decentralized way.

Second, this contract is deployed on the Rinkeby test network and a user interface to interact with it is being served from [IPFS](https://ipfs.io/ipfs/QmVBNRnsnCLfgnsFBbq3VbN58hWDWXb4JBT2FBZsJoh34E/) and [IPNS](https://ipfs.io/ipns/QmNkKRmt2ByQFhxftJCLXPga2xgnyqarpKYBri8EJSwqjv/). Because the centralized nature of the market makes it not very fun to interact with, I added another smart contract as an administrator that automatically approves anyone requesting it to be a store owner. Navigate to the user interface and add yourself as a store owner. Make sure you are on the Rinkeby test network to do this. Try creating a store with some products and then switch to another account to buy some products that others have listed. Note that this can be slow to load so please be patient!

This use of another smart contract as an administrator is an interesting example of how interactions between smart contracts can be used to upgrade contract functionality. The market itself is highly centralized, with administrators having to approve store owners before they can create stores. But by creating a smart contract as an administrator that automatically approves requests from users the owner can make the market much more decentralized. And if the owner wants to switch back he can remove the smart contract administrator, returning to the original more centralized structure. All of this can be accomplished with no changes to the `Market` smart contract itself.

If you have any questions or comments please reach out to me at <adam.fraser@gmail.com>. Thanks for taking the time to read this!